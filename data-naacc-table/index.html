<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<link href="../img/favicon.ico" rel="shortcut icon"/>
<title>Working with NAACC Culvert Data - Culvert Analysis Toolkit</title>
<link href="../css/bootstrap.min.css" rel="stylesheet"/>
<link href="../css/font-awesome.min.css" rel="stylesheet"/>
<link href="../css/base.css" rel="stylesheet"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" rel="stylesheet"/>
<script defer="" src="../js/jquery-1.10.2.min.js"></script>
<script defer="" src="../js/bootstrap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<link href="..\pdf\document.pdf" rel="alternate" title="PDF" type="application/pdf"/></head>
<body>
<div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
<div class="container">
<a class="navbar-brand" href="..">Culvert Analysis Toolkit</a>
<!-- Expander button -->
<button class="navbar-toggler" data-target="#navbar-collapse" data-toggle="collapse" type="button">
<span class="navbar-toggler-icon"></span>
</button>
<!-- Expanded navigation -->
<div class="navbar-collapse collapse" id="navbar-collapse">
<!-- Main navigation -->
<ul class="nav navbar-nav">
<li class="navitem">
<a class="nav-link" href="..">Overview</a>
</li>
<li class="navitem">
<a class="nav-link" href="../install/">Install</a>
</li>
<li class="dropdown active">
<a class="nav-link dropdown-toggle" data-toggle="dropdown" href="#">Data Prep Guides <b class="caret"></b></a>
<ul class="dropdown-menu">
<li>
<a class="dropdown-item" href="../data-overview/">Overview</a>
</li>
<li>
<a class="dropdown-item active" href="./">Working with NAACC Culvert Data</a>
</li>
<li>
<a class="dropdown-item" href="../data-dem/">Digital Elevation Model-derived Data</a>
</li>
<li>
<a class="dropdown-item" href="../data-curve-number-raster/">Generating a Curve Number Raster</a>
</li>
<li>
<a class="dropdown-item" href="../data-noaa-rainfall/">Getting NOAA Rainfall Data</a>
</li>
</ul>
</li>
<li class="dropdown">
<a class="nav-link dropdown-toggle" data-toggle="dropdown" href="#">Analysis Guides <b class="caret"></b></a>
<ul class="dropdown-menu">
<li>
<a class="dropdown-item" href="../analysis-overview/">Toolbox Overview</a>
</li>
<li>
<a class="dropdown-item" href="../capacitycalc-run-one/">The Capacity Calculator Workflow</a>
</li>
<li>
<a class="dropdown-item" href="../capacitycalc-results/">Working with Capacity Calculator Results</a>
</li>
</ul>
</li>
<li class="dropdown">
<a class="nav-link dropdown-toggle" data-toggle="dropdown" href="#">Calculators <b class="caret"></b></a>
<ul class="dropdown-menu">
<li>
<a class="dropdown-item" href="../calcs-peak-flow/">Peak Flow</a>
</li>
<li>
<a class="dropdown-item" href="../calcs-culvert-capacity/">Culvert Capacity</a>
</li>
</ul>
</li>
<li class="navitem">
<a class="nav-link" href="../dev/">Develop</a>
</li>
</ul>
<ul class="nav navbar-nav ml-auto">
<li class="nav-item">
<a class="nav-link" href="../data-overview/" rel="prev">
<i class="fa fa-arrow-left"></i> Previous
                                </a>
</li>
<li class="nav-item">
<a class="nav-link" href="../data-dem/" rel="next">
                                    Next <i class="fa fa-arrow-right"></i>
</a>
</li>
</ul>
</div>
</div>
</div>
<div class="container">
<div class="row">
<div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
<div class="navbar-header">
<button class="navbar-toggler collapsed" data-target="#toc-collapse" data-toggle="collapse" title="Table of Contents" type="button">
<span class="fa fa-angle-down"></span>
</button>
</div>
<div class="navbar-collapse collapse card bg-secondary" id="toc-collapse">
<ul class="nav flex-column">
<li class="nav-item" data-level="1"><a class="nav-link" href="#working-with-naacc-culvert-data">Working with NAACC Culvert Data</a>
<ul class="nav flex-column">
<li class="nav-item" data-level="2"><a class="nav-link" href="#initial-download-and-clean-up">Initial Download and Clean-Up</a>
<ul class="nav flex-column">
<li class="nav-item" data-level="3"><a class="nav-link" href="#1-download-the-excel-xls-file-from-naaccs-website">1. Download the Excel (xls) file from NAACC's website</a>
<ul class="nav flex-column">
</ul>
</li>
<li class="nav-item" data-level="3"><a class="nav-link" href="#2-clean-up">2. Clean-Up</a>
<ul class="nav flex-column">
</ul>
</li>
<li class="nav-item" data-level="3"><a class="nav-link" href="#3-save-as-a-csv-file">3. Save as a CSV file</a>
<ul class="nav flex-column">
</ul>
</li>
</ul>
</li>
<li class="nav-item" data-level="2"><a class="nav-link" href="#run-the-naacc-table-ingest-tool">Run the NAACC Table Ingest tool</a>
<ul class="nav flex-column">
<li class="nav-item" data-level="3"><a class="nav-link" href="#what-is-changed-in-the-data-by-this-tool">What is changed in the data by this tool:</a>
<ul class="nav flex-column">
</ul>
</li>
</ul>
</li>
<li class="nav-item" data-level="2"><a class="nav-link" href="#optionally-run-the-naacc-data-snapping-tool">Optionally: Run the NAACC Data Snapping tool</a>
<ul class="nav flex-column">
<li class="nav-item" data-level="3"><a class="nav-link" href="#what-is-changed-in-the-data-by-this-tool_1">What is changed in the data by this tool:</a>
<ul class="nav flex-column">
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div></div>
<div class="col-md-9" role="main">
<h1 id="working-with-naacc-culvert-data">Working with NAACC Culvert Data</h1>
<p>NAACC provides a data standard for capturing culvert data. Much of this toolkit relies on input data having been provided according to that standard.</p>
<p>Follows is a process for getting</p>
<h2 id="initial-download-and-clean-up">Initial Download and Clean-Up</h2>
<p>Raw data from NAACC comes in the form of an Excel spreadsheet file (<code>xls</code>). The sheet includes headers. For it to be readable by the toolkit, we need it to be purely tabular.</p>
<h3 id="1-download-the-excel-xls-file-from-naaccs-website">1. Download the Excel (<code>xls</code>) file from <a href="https://naacc.org/naacc_search_crossing.cfm">NAACC's website</a></h3>
<p>Select your area of interest:</p>
<p><img alt="" src="../assets/naacc-download-form.png"/></p>
<p>Download the "detailed" type:</p>
<p><img alt="" src="../assets/naacc-download-types.png"/></p>
<p>This will give you an <code>xls</code> file, which you can open in Excel or other spreadsheet software.</p>
<p><strong>Do not download</strong> the shapefile available from NAACC. It does not have all the fields required for modeling and is limited to crossing locations only.</p>
<h4 id="identification">Identification</h4>
<ul>
<li><code>Survey_Id</code> is the ID of the crossing</li>
<li><code>Naacc_Culvert_Id</code> is the ID of the culvert</li>
</ul>
<p>Both of these values together are used through the remainder of the tools to differentiate and aggregrate records where necessary. To make compatible with some other GIS tools (specifically, raster process tools), we store IDs as integers (not text).</p>
<h3 id="2-clean-up">2. Clean-Up</h3>
<p>Minmially, delete the file header (the first four rows) from the XLS file. The table needs to be in purely tabular format in order to be read and validated by other tools.</p>
<p><img alt="" src="../assets/naacc-detail-header.png"/> <em>Remove rows 1-4 containing the notice about crossing record structure. The column names should end up in row 1.</em></p>
<h4 id="optionally-pre-process-the-naacc-records">Optionally: Pre-process the NAACC records</h4>
<p>You may want to pair back the download to records of interest or otherwise do some QA/QC on the raw NAACC data; for example:</p>
<ul>
<li>remove certain types of culvert, e.g., bridges, fords, or ones that don't have any capacity measurements.</li>
<li>remove multiple older surveys for crossing locations, or pick the survey with the most complete information</li>
<li>import this table into GIS and georeference it yourself, in order to move features to streams or flow lines on a digital elevation model</li>
</ul>
<p>Regardless, as long as the original NAACC schema is preserved through your process, subsequent tools will be able to use it.</p>
<p>The <a href="#run-the-naacc-table-ingest-tool"><em>NAACC Table Ingest</em> (described below)</a> will automatically flag records that aren't valid for capacity calculations, including those that aren't culverts or multi-culverts, or are missing measurements and classifications required for calculating capacity.</p>
<h3 id="3-save-as-a-csv-file">3. Save as a CSV file</h3>
<p>Subsequent tools work on CSV files or feature classes in </p>
<h2 id="run-the-naacc-table-ingest-tool">Run the <em>NAACC Table Ingest</em> tool</h2>
<p>The <em>NAACC Table Ingest</em> tool will read in, validate, and extend a NAACC-compliant source table, and save the output as geodata, i.e., an Esri file geodatabase feature class.</p>
<p>Use your prepared CSV as an input. Note that if you've imported that <code>CSV</code> to a file geodatabase table or feature class already, that feature class will also work as an input.</p>
<p>This tool will: </p>
<ul>
<li>validate the records (e.g., check if the measurements for dimensional fields are positive numbers)</li>
<li>flag those that aren't valid inputs to the tool (either they aren't the right kind of infrastructure or they have invalid field values)</li>
<li>add new toolkit-specific fields and extract-transform-load individual values to those fields, typically doing either a unit conversion (imperial to metric) or a text-based crosswalk (for certain descriptive fields like crossing, inlet, and outlet types)</li>
</ul>
<h3 id="what-is-changed-in-the-data-by-this-tool">What is changed in the data by this tool:</h3>
<p>New fields related to data validation: </p>
<ul>
<li><code>include</code> </li>
<li><code>validation_errors</code></li>
</ul>
<p>New fields for storing transformed copies of capacity model-specific attributes (e.g. values with unit conversion applied).</p>
<ul>
<li><em>NAACC field: new field</em></li>
<li><code>Crossing_Type</code>: <code>xing_type</code></li>
<li><code>Crossing_Comment</code>: <code>comments</code></li>
<li><code>Crossing_Structure_Length</code>: <code>length</code></li>
<li><code>Road_Fill_Height</code>: <code>hw</code></li>
<li><code>Inlet_Type</code>: <code>in_type</code></li>
<li><code>Inlet_Structure_Type</code>: <code>in_shape</code></li>
<li><code>Inlet_Width</code>: <code>in_a</code></li>
<li><code>Inlet_Height</code>: <code>in_b</code></li>
<li><code>Material</code>: <code>culv_mat</code></li>
<li><code>Slope_Percent</code>: <code>slope</code></li>
<li><code>Outlet_Structure_Type</code>: <code>out_shape</code></li>
<li><code>Outlet_Width</code>: <code>out_a</code></li>
<li><code>Outlet_Height</code>: <code>out_b</code></li>
</ul>
<p>New fields for storing calculator results:</p>
<ul>
<li><code>culvert_capacity</code>: the capacity of the culvert</li>
<li><code>crossing_capacity</code>: the total capacity of the crossing (of which this culvert record may be one of many culverts). If just one culvert in the crossing, this is the same as <code>culvert_capacity</code>, otherwise it is the sum of <code>culvert_capacity</code> for all culverts in the crossing</li>
<li><code>max_return_period</code>: the max return period for the crossing</li>
</ul>
<h2 id="optionally-run-the-naacc-data-snapping-tool">Optionally: Run the <em>NAACC Data Snapping</em> tool</h2>
<p>Depending on your needs, you may find that the location precision of the supplied NAACC data was not adequate compared to the accuracy of your <a href="../data-dem/">hydrologically corrected DEM</a>. In that case, you may have moved culverts manually or snapped points to streams.</p>
<p>If you need to update your NAACC table with better location data from an external table--a <em>Adjusted Geometry File</em>--use the <em>NAACC Data Snapping tool</em> to update the input NAACC-compliant source table with locations from another table.</p>
<p>This tool basically runs a reverse 1-to-many join, replacing geometry in one or more feature class records with a single geometry from feature in a reference table using a column-based match.</p>
<p>This tool generates a new feature class. An additional field <code>moved</code> is added indicating whether the culvert has been moved based on a match with the <em>Adjusted Geometry File</em>.</p>
<h3 id="what-is-changed-in-the-data-by-this-tool_1">What is changed in the data by this tool:</h3>
<ul>
<li>updated geometry</li>
<li>new field: <code>moved</code>: a boolean field indicating if the record has been re-snapped based on the supplied reference geometry.</li>
</ul></div>
</div>
</div>
<footer class="col-md-12">
<hr/>
<p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
</footer>
<script>
            var base_url = "..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
<script defer="" src="../js/base.js"></script>
<div aria-hidden="true" aria-labelledby="keyboardModalLabel" class="modal" id="mkdocs_keyboard_modal" role="dialog" tabindex="-1">
<div class="modal-dialog">
<div class="modal-content">
<div class="modal-header">
<h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
<button class="close" data-dismiss="modal" type="button"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button>
</div>
<div class="modal-body">
<table class="table">
<thead>
<tr>
<th style="width: 20%;">Keys</th>
<th>Action</th>
</tr>
</thead>
<tbody>
<tr>
<td class="help shortcut"><kbd>?</kbd></td>
<td>Open this help</td>
</tr>
<tr>
<td class="next shortcut"><kbd>n</kbd></td>
<td>Next page</td>
</tr>
<tr>
<td class="prev shortcut"><kbd>p</kbd></td>
<td>Previous page</td>
</tr>
<tr>
<td class="search shortcut"><kbd>s</kbd></td>
<td>Search</td>
</tr>
</tbody>
</table>
</div>
<div class="modal-footer">
</div>
</div>
</div>
</div>
</body>
</html>
